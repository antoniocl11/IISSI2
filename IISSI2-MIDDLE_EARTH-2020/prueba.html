<!DOCTYPE html>
<html>
<meta charset="utf-8">

<script type="text/javascript">
//Validacion Fecha
//Funcion que devuelve true or false dependiendo si la fecha es correcta o no

function isValidDate(dia, mes,anyo){
    var dteDate;

    mes = month - 1;
    //El mes lo restamos con 1 porque en js el mes empieza en la posicion 0 y termina en
    //la 11, siendo 0 el mes de enero

    dteDate = new Date(anyo, mes, dia);
    //getDate() devuelve el dia como un entero entre 1 y 31
    //getMonth() devuelve el mes como un entero entre 0 y 11
    //getFullYear() devuele el año
    return ((dia=dteDate.getDate()) && (month==dteDate.getMonth()) && year==dteDate.getFullYear());
    //si se cumple true
}

//Funcion  para validad una fecha
function validar_fecha(fecha){
    var patron = RegExp("^(19|20)+([0-9]{2})([-])([0-9]{1,2})([-])([0-9]{1,2})$");

    if(fecha.search(patron)==0){
        var values = fecha.split("-"); //porque es una fecha inglesa yyyy-mm-dd
        if(isValidDate(values[2],values[1],values[0])){
            return true;
        }
    }

    return false;
}

//Funcion para calcular y validad la edad en el formulario (No permitido el registro a menores de 16 años)
function validacion_fechaNacimiento(){
    var fecha = document.getElementById("fechaNacimiento").value;
    var error;

    //if(validar_fecha(fecha) == true){
        //si la fecha es correcta calculamos la edad
        var values = fecha.split("-");
        var dia = values[2];
        var mes = values[1];
        var anyo = values[0];


        var fecha_actual = new Date();
        var año_actual = fecha_actual.getYear();
        var dia_actual = fecha_actual.getDate();
        var mes_actual = fecha_actual.getMonth();

        //Calculo de la edad

        var edad = (año_actual + 1900) - anyo;

        if(mes_actual < (mes-1)){
            edad --;
        }

        if(((mes - 1) == mes_actual) && (dia_actual < dia)){
            edad --;
        }

        if(edad > 1900){
            edad -= 1900
        }
            
        document.getElementById("result").innerHTML="Tienes "+edad+" años";

        if(edad < 16){
            document.getElementById("result").innerHTML="Edad incorrecta";
        }
   /*     
    }
    else{
        document.getElementById("result").innerHTML="La fecha "+fecha+" es incorrecta";
    }
/*
    if(edad < 16){
        error = "prueba";
    }

    fecha.setCustomValidity(error);
    return error;
    */
}

</script>

<body>
    <input type="date" name="fechaNacimiento" id="fechaNacimiento" />
    <input type="button" value="Calcular edad" onclick="validacion_fechaNacimiento();" />
    <!-- div donde mostraremos el resultado -->
    <div id="result"></div>
</body>
</html>